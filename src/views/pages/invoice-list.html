<div class="container m-t-25 invoices invoice-list">

  <div class="card">
    <div class="card-header">
      <h2>
        FATTURE <small>List of invoices.</small>
      </h2>
    </div>

    <!-- CUSTOMER ONLY -->
    <div class="card-body" permission permission-only="['CUSTOMER']">
      <div class="table-responsive" ng-if="invoices.length && !isLoading">
        <table ng-table="mattersTable" class="table table-striped table-vmiddle">
          <tr ng-repeat="m in invoices">
            <td data-title="'Title'" sortable="'title'">
              <a ui-sref="page.invoice-details({id: m.id})">{{ m.matter.title }}</a>
            </td>
            <td data-title="'Paid'" sortable="'m.paid'">
              <div class="flag flag-pending" ng-if="!m.paid">Not Paid</div>
              <div class="flag flag-success" ng-if="m.paid">Paid</div>
            </td>
            <td data-title="'Type'">
              <div ng-if="m.is_deposit">Deposit</div>
              <div ng-if="m.is_balance">Balance</div>
              <div ng-if="!m.is_balance && !m.is_deposit">Summary</div>
            </td>
            <td data-title="'Payment'" sortable="'m.is_confirmed'">
              <div class="flag flag-success" ng-if="m.is_confirmed">Confirmed</div>
              <div class="flag flag-closed" ng-if="!m.is_confirmed">Not Confirmed</div>
            </td>
            <td data-title="'Status'" sortable="'m.number'">
              <div class="flag flag-pending" ng-if="!m.number">Not legal</div>
              <div class="flag flag-success" ng-if="m.number">Ready</div>
            </td>
            <td data-title="'Lawyer'" sortable="'m.owner.first_name'">
              <a ui-sref="profile.details({id: m.owner.id})">{{m.owner.first_name}} {{m.owner.last_name}}</a>
            </td>
            <td data-title="'Paid Date'" sortable="'created_at'">
              {{m.created_at | amDateFormat: "DD MMMM YYYY" }}
            </td>
          </tr>
        </table>
      </div>
    </div>

    <!-- Lawyer ONLY -->
    <div class="card-body" permission permission-only="['LAWYER']">
      <div class="table-responsive" ng-if="invoices.length && !isLoading">
        <table ng-table="mattersTable" class="table table-striped table-vmiddle">
          <tr ng-repeat="m in invoices">
            <td data-title="'Title'" sortable="'title'">
              <a ui-sref="page.invoice-details({id: m.id})">{{ m.matter.title }}</a>
            </td>
            <td data-title="'Paid'" sortable="'m.paid'">
              <div class="flag flag-pending" ng-if="!m.paid">Not Paid</div>
              <div class="flag flag-success" ng-if="m.paid">Paid</div>
            </td>
            <td data-title="'Type'">
              <div ng-if="m.is_deposit">Deposit</div>
              <div ng-if="m.is_balance">Balance</div>
              <div ng-if="!m.is_balance && !m.is_deposit">Summary</div>
            </td>
            <td data-title="'Payment'" sortable="'m.is_confirmed'">
              <div class="flag flag-success" ng-if="m.is_confirmed">Confirmed</div>
              <div class="flag flag-closed" ng-if="!m.is_confirmed">Not Confirmed</div>
            </td>
            <td data-title="'Status'" sortable="'m.number'">
              <div class="flag flag-pending" ng-if="!m.number">Not legal</div>
              <div class="flag flag-success" ng-if="m.number">Ready</div>
            </td>
            <td data-title="'Customer'" sortable="'m.customer.first_name'">
              <a ui-sref="profile.details({id: m.customer.id})">{{m.customer.first_name}} {{m.customer.last_name}}</a>
            </td>
            <td data-title="'Paid Date'" sortable="'created_at'">
              {{m.created_at | amDateFormat: "DD MMMM YYYY" }}
            </td>
          </tr>
        </table>
      </div>
    </div>

    <div class="alert alert-danger" ng-if="invoices.length == 0 && !isLoading">
      There are no Invoices.
    </div>
    <div class="isLoading" ng-if="isLoading">
      <div class="loader">
        <div class="loader-inner ball-pulse-sync">
          <div ng-repeat="i in [1,2,3]"></div>
        </div>
      </div>
    </div>
  </div>

</div>
